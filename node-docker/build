#!/bin/bash

# Build script for Node.js development container
# Usage: ./build [--no-cache] [tag]

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$SCRIPT_DIR"

# Default values
DEFAULT_TAG="genworks/skewed-node:devo"
NO_CACHE=""
TAG="${DEFAULT_TAG}"

# Parse arguments
while [[ $# -gt 0 ]]; do
    case $1 in
        --no-cache)
            NO_CACHE="--no-cache"
            shift
            ;;
        *)
            TAG="$1"
            shift
            ;;
    esac
done

echo "Building Node.js development container..."
echo "Tag: $TAG"
echo "No cache: ${NO_CACHE:-false}"
echo

# Build the image
docker build $NO_CACHE -t "$TAG" .

echo
echo "âœ… Build completed successfully!"
echo "Image: $TAG"
echo
echo "Usage:"
echo "  docker run --rm -it $TAG /bin/bash"
echo "  docker compose up node"
echo